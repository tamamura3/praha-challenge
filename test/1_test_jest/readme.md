# 課題2
後ほどURLを記載

# 課題3
## 依存性の注入について
プログラムが外部のリソース（DB、APIなど）に依存している場合、外部のリソースの実行結果により、プログラムの実行結果が変化してしまう。
例えば、プログラムの中でDBの登録処理がある場合、どのDBを使うかにより処理が成功にも失敗にもなる。そうすると、成功するDBをプログラムの中で固定して利用しまうと、常に結果が成功になってしまい、テストでカバレッジ100%を達成できない。
ちなみに外部リソースを利用しないプログラムであれば、引数を変更すれば成功も失敗もテストできるので、カバレッジ100%を達成できる。

カバレッジ100%を達成できない問題を解決するために利用できるのが、外部リソースの処理を疑似的に作成し結果を固定し、それをテストしたい関数に引数として渡す方法。
先ほどの例だと、まず疑似的なDB登録処理を作成し、結果を固定させる（常に成功するor常に失敗する）。テスト対象の関数ではその処理を引数として受け取りDB登録処理をすることで、DB登録処理の結果が安定しているため、純粋に製品コードだけをテストすることができる。

このように、外部からインスタンス変数やメソッドなどを渡せるようにすることで、今まで外部依存だった部分に柔軟性を持たせる手法を「依存性の注入」という。
依存性の注入を行うと、モジュール同士の結合度が弱くなる。

## 外部サービスとの通信
単体テストで外部サービスと通信が発生すると、外部サービスの実行結果が安定しない。
例えば、一時的にサービスが止まっていて、製品コードが問題ないのにテストが失敗するなど。

単体テストは個々の関数が正しく動くかの確認なので、外部サービスの実行結果に依存すると、結果が安定せずテストがしにくい。
外部サービスを動かしてプログラム全体をテストするのは統合テストのような後ろのフェーズでよいと考える。

## sumOfArrayの修正
reduceの初期値に0を与え、空の配列の場合は0を返すように修正。
併せてテストも期待値が0で比較するように修正。

## Property Based testing
Property Based Testingは専用のツールを使用してより網羅的にテストをする仕組み。
例えば「一つの自然数」という性質（property）を定義すれば、性質に当てはまるありとあらゆる入力値が自動的に作成されテストされる。（1、33、738470107など）
その入力値をテスト対象の関数に渡してテストすれば、人力より網羅的にテストができ、コード品質の向上に繋がる。

反対にExample Based Testingという言葉があり、これは多くの人がいつもやっている、
数ある入力値からいくつかを選出してテストする方法
これは数ある入力値から人力で選出しテストする方法。

Property Based Testingを使用しない方が良いケースがあるとすれば、一回の実行に時間がかかる処理が考えられる。

## 単体テストでの工夫
- Arrenge-Act-Assert
テストコードを3段階に分けてコメントして管理することで、どこで何をしているか、何のテストをしているかを理解しやすくする方法。Arrengeでは入力値や初期化など、テストに必要なデータを準備する。Actでは、関数やAPIなどテスト対象の実行を行う。Assertでは結果を判定する。
- 一つのユニットテストに複数assertを書かない
一つのユニットテストで複数のassertを実行すると、エラー時にそれ以降のテストが実行されないので注意。
- テスト内にロジックを書かない
テストの中にロジックを書くと、そのロジックにバグが生まれる可能性があるので、極力避ける。
if, for, whileなどを使うようであれば注意し、必要であれば複数のテストケースに分ける。
参考：https://www.simform.com/blog/unit-testing-best-practices/

# 課題4
## クイズ 関数
4_functions.tsを参照

## クイズ jest
### 1. オブジェクトの等価を判定するmatcharのtoBeとtoEqualの違いは？
### 2. expect()がない場合のテスト結果はどうなる？
### 3. 実行結果のFile, Stmts, Branch, Funcs, Lines, Uncoverd Lineはそれぞれ何を意味してる？

# 課題5
- テストの名前には「～されるかどうか」のようなテスト観点を書くとわかりやすいと感じた。
例：「[]の配列を引数に渡した場合」×
　　「空配列の場合0が返却されるかどうか」〇
- テスト実行前にbeforeEachなどでスナップショットを取り、完了後afterEachでスナップショットを戻せば常に同じ状態で各テストを実行できる

https://github.com/PostHog/posthog
https://github.com/n8n-io/n8n
